<Project>
  <!--
    MAUI関連の設定
    対応プラットフォームは、Windows/Androidのみ。
  -->

  <PropertyGroup>
    <IsPublishable>true</IsPublishable>
  </PropertyGroup>

  <Import Project="$(BuildCommonDirectory)/Xamarin.targets" />
  <Import Condition="'$(TargetPlatformIdentifier)' == 'windows'" Project="$(BuildCommonPlatformDirectory)/WinUI.targets" />

  <PropertyGroup Condition="'$(TargetPlatformIdentifier)' == 'windows'">
    <SupportedOSPlatformVersion>$(TargetPlatformMinVersion)</SupportedOSPlatformVersion>

    <!-- trueだとコンパイルエラーとなる。 -->
    <PublishSingleFile>false</PublishSingleFile>
  </PropertyGroup>

  <!-- repository.json出力の際に使用する。 -->
  <ItemGroup>
    <ProjectIdentifier Include="Windows" />
    <ProjectIdentifier Include="Android" />
  </ItemGroup>

  <Import Condition="'$(TargetPlatformIdentifier)' == 'android'" Project="$(BuildCommonDirectory)/Android.targets" />

  <!-- MAUI関連の検証を行うターゲット。 -->
  <Target Name="CheckMAUI" BeforeTargets="BeforeBuild">
    <!--
      SingleProjectは、Directory.Build.targetsだけでtrueに設定した場合、コンパイルエラーとなる。
      そのため、csprojまたはDirectory.Build.propsでtrueに設定する必要がある。
      Directory.Build.propsでは出力ファイルの種類やフレームワークでの分岐はできないため、SingleProjectの設定を共通化できない。
      csprojでの設定を強制する必要があるため、true以外の場合はコンパイルエラーとする。
    -->
    <Error Condition="'$(SingleProject)' != 'true'" Text="SingleProject must be true." />
  </Target>

</Project>
